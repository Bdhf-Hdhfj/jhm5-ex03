<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Todo - Cloud</title>
    <link rel="stylesheet" href="/global.css" />
    <style>body{font-family:system-ui;padding:20px}ul{padding:0;list-style:none}li{padding:8px;border-bottom:1px solid #eee}</style>
  </head>
  <body>
    <h1>Todo (Cloud)</h1>
    <div>
      <input id="newitem" placeholder="Add item" /> <button id="add">Add</button>
    </div>
    <ul id="list"></ul>
    <script>
      const base='/api/todos';async function load(){const r=await fetch(base);return r.json()}async function add(text){await fetch(base,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text})})}
      async function remove(id){await fetch(base+'/'+id,{method:'DELETE'})}
      async function toggle(id){await fetch(base+'/'+id,{method:'PATCH'})}
      async function render(){const items=await load();const ul=document.getElementById('list');ul.innerHTML='';items.forEach(it=>{const li=document.createElement('li');li.textContent=(it.done? 'âœ… ':'')+it.text;li.onclick=()=>toggle(it.id).then(render);const del=document.createElement('button');del.textContent='Delete';del.onclick=(e)=>{e.stopPropagation();remove(it.id).then(render)};li.appendChild(del);ul.appendChild(li)})}
      document.getElementById('add').onclick=async()=>{const v=document.getElementById('newitem').value.trim();if(!v)return;await add(v);document.getElementById('newitem').value='';render()}
      render();
    </script>
  </body>
</html>
